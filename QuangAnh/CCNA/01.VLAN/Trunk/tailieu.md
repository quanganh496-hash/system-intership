# 1. Trunk l√† g√¨?
- Trunk l√† m·ªôt ƒë∆∞·ªùng k·∫øt n·ªëi gi·ªØa hai thi·∫øt b·ªã m·∫°ng (th∆∞·ªùng l√† switch‚Äìswitch ho·∫∑c switch‚Äìrouter) c√≥ th·ªÉ truy·ªÅn nhi·ªÅu VLAN c√πng l√∫c tr√™n c√πng m·ªôt ƒë∆∞·ªùng truy·ªÅn v·∫≠t l√Ω.
- ƒê·ªÉ ph√¢n bi·ªát d·ªØ li·ªáu c·ªßa t·ª´ng VLAN, trunk s·∫Ω g·∫Øn th√™m th·∫ª VLAN (tag) v√†o khung Ethernet khi truy·ªÅn.
- Th∆∞·ªùng s·ª≠ d·ª•ng giao th·ª©c 802.1Q ƒë·ªÉ ƒë√°nh d·∫•u (tag) c√°c g√≥i tin.

üí° N√≥i ƒë∆°n gi·∫£n: N·∫øu VLAN l√† ‚Äúph√≤ng‚Äù v√† switch l√† ‚Äút√≤a nh√†‚Äù, th√¨ trunk gi·ªëng nh∆∞ c·∫ßu thang chung n·ªëi c√°c t√≤a nh√†, nh∆∞ng m·ªói ng∆∞·ªùi ƒëi tr√™n c·∫ßu thang v·∫´n ƒëeo ‚Äúth·∫ª ph√≤ng‚Äù ƒë·ªÉ bi·∫øt m√¨nh thu·ªôc ph√≤ng n√†o.
## 2. Chu·∫©n IEEE 802.1Q (DOT1Q)
- Gi·ªëng nh∆∞ ISL, 802.1Q l√† m·ªôt giao th·ª©c cho ph√©p m·ªôt li√™n k·∫øt v·∫≠t l√Ω c√≥ th·ªÉ th·ª±c hi·ªán mang l∆∞u l∆∞·ª£ng c·ªßa nhi·ªÅu VLAN. ƒê√¢y l√† ti√™u chu·∫©n VLAN trunking protocol c·ªßa IEEE. Thay v√¨ ƒë√≥ng g√≥i c√°c frame l·ªõp 2 ban ƒë·∫ßu, 802.1Q ch√®n m·ªôt th·∫ª v√†o header Ethernet, sau ƒë√≥ t√≠nh to√°n l·∫°i v√† c·∫≠p nh·∫≠t c√°c FCS trong frame ngu·ªìn v√† truy·ªÅn qua li√™n k·∫øt trunk.

![alt text](./images/image.png)

- IEEE 802.1Q l√† m·ªôt chu·∫©n chung d√πng ƒë·ªÉ nh·∫≠n d·∫°ng c√°c VLAN ƒë∆∞·ª£c truy·ªÅn qua ƒë∆∞·ªùng trung k·∫ø, n√≥ ho·∫°t ƒë·ªông trong m√¥i tr∆∞·ªùng Ethernet v√† l√† m·ªôt chu·∫©n m·ªü. L√† giao th·ª©c d√πng g√°n nh√£n frame khi truy·ªÅn frame tr√™n ƒë∆∞·ªùng trung k·∫ø gi·ªØa hai Switch hay gi·ªØa Switch v√† Router, vi·ªác g√°n nh√£n frame ƒë∆∞·ª£c th·ª±c hi·ªán b·∫±ng c√°ch th√™m th√¥ng tin VLAN ID v√†o ph·∫ßn gi·ªØa header tr∆∞·ªõc khi frame ƒë∆∞·ª£c truy·ªÅn l√™n ƒë∆∞·ªùng trung k·∫ø
![alt text](./images/image-1.png)
**C√°ch ho·∫°t ƒë·ªông**:
- Th√™m m·ªôt th·∫ª (tag VLAN) v√†o g√≥i tin Ethernet ƒë·ªÉ x√°c ƒë·ªãnh VLAN m√† n√≥ thu·ªôc v·ªÅ.
- K√≠ch th∆∞·ªõc tag VLAN: 4 byte (32 bit) ƒë∆∞·ª£c ch√®n v√†o gi·ªØa ph·∫ßn Header v√† Payload c·ªßa g√≥i tin Ethernet.
- Kh√°i ni·ªám Native VLAN: G√≥i tin thu·ªôc Native VLAN s·∫Ω kh√¥ng g·∫Øn tag khi truy·ªÅn qua Trunk.

| **Tr∆∞·ªùng**                          | **K√≠ch th∆∞·ªõc**  | **M√¥ t·∫£**                                                                                     |
| ----------------------------------- | --------------- | --------------------------------------------------------------------------------------------- |
| **TPID** (Tag Protocol Identifier)  | 16 bit (2 byte) | Gi√° tr·ªã m·∫∑c ƒë·ªãnh **0x8100** ƒë·ªÉ x√°c ƒë·ªãnh ƒë√¢y l√† khung Ethernet c√≥ g·∫Øn th·∫ª VLAN.                |
| **TCI** (Tag Control Information)   | 16 bit (2 byte) | G·ªìm 3 ph·∫ßn nh·ªè:                                                                               |
| ‚Üí **PCP** (Priority Code Point)     | 3 bit           | X√°c ƒë·ªãnh m·ª©c ƒë·ªô ∆∞u ti√™n (QoS ‚Äì IEEE 802.1p), gi√° tr·ªã t·ª´ 0‚Äì7.                                  |
| ‚Üí **DEI** (Drop Eligible Indicator) | 1 bit           | Cho bi·∫øt g√≥i tin c√≥ th·ªÉ b·ªã lo·∫°i b·ªè khi m·∫°ng qu√° t·∫£i (0 = gi·ªØ, 1 = c√≥ th·ªÉ b·ªè).                 |
| ‚Üí **VID** (VLAN Identifier)         | 12 bit          | X√°c ƒë·ªãnh VLAN ID, gi√° tr·ªã t·ª´ 0‚Äì4095 (0 v√† 4095 l√† gi√° tr·ªã ƒë·∫∑c bi·ªát, VLAN h·ª£p l·ªá: **1‚Äì4094**). |

V√≠ d·ª• VLAN Tagging v·ªõi 802.1Q:

- G√≥i tin t·ª´ VLAN 10 khi truy·ªÅn qua Trunk Port s·∫Ω ƒë∆∞·ª£c th√™m Tag VLAN 10. Switch nh·∫≠n ƒë∆∞·ª£c g√≥i tin s·∫Ω ƒë·ªçc tag n√†y ƒë·ªÉ bi·∫øt n√≥ thu·ªôc VLAN n√†o.
### 3.Access port v√† Trunk port

![alt text](./images/image-2.png)

Access port (C·ªïng truy nh·∫≠p) trong m·∫°ng m√°y t√≠nh, ƒë·∫∑c bi·ªát l√† tr√™n switch, l√† lo·∫°i c·ªïng ƒë∆∞·ª£c c·∫•u h√¨nh ƒë·ªÉ ch·ªâ thu·ªôc v·ªÅ m·ªôt VLAN duy nh·∫•t v√† th∆∞·ªùng ƒë∆∞·ª£c d√πng ƒë·ªÉ k·∫øt n·ªëi v·ªõi c√°c thi·∫øt b·ªã cu·ªëi nh∆∞ m√°y t√≠nh, m√°y in, camera IP...
- Ch·ªâ thu·ªôc v·ªÅ m·ªôt VLAN: T·∫•t c·∫£ l∆∞u l∆∞·ª£ng ƒëi qua c·ªïng s·∫Ω ƒë∆∞·ª£c g√°n v√†o VLAN ƒë√≥.
- Kh√¥ng g·∫Øn th·∫ª VLAN (untagged): Frame Ethernet g·ª≠i ra t·ª´ access port kh√¥ng ch·ª©a th·∫ª VLAN 802.1Q. Switch **t·ª± ƒë·ªông g√°n VLAN ID** t∆∞∆°ng ·ª©ng v·ªõi c·∫•u h√¨nh c·ªßa c·ªïng.
Khi g·ª≠i frame ra kh·ªèi access port, switch b·ªè **VLAN tag** ƒë·ªÉ thi·∫øt b·ªã cu·ªëi nh·∫≠n ƒë∆∞·ª£c frame b√¨nh th∆∞·ªùng.
- D√πng cho thi·∫øt b·ªã kh√¥ng h·ªó tr·ª£ VLAN: V√≠ d·ª• PC, m√°y in ‚Äî c√°c thi·∫øt b·ªã n√†y th∆∞·ªùng kh√¥ng hi·ªÉu ho·∫∑c kh√¥ng x·ª≠ l√Ω ƒë∆∞·ª£c VLAN tag.

**So s√°nh Access port vs Trunk port**
| Ti√™u ch√≠        | Access Port           | Trunk Port                                             |
| --------------- | --------------------- | ------------------------------------------------------ |
| VLAN            | M·ªôt VLAN duy nh·∫•t     | Nhi·ªÅu VLAN                                             |
| Th·∫ª VLAN 802.1Q | Kh√¥ng (untagged)      | C√≥ (tagged)                                            |
| K·∫øt n·ªëi         | Thi·∫øt b·ªã cu·ªëi         | Gi·ªØa switch v·ªõi switch, router ho·∫∑c server h·ªó tr·ª£ VLAN |
| V√≠ d·ª• s·ª≠ d·ª•ng   | PC, m√°y in, camera IP | Li√™n k·∫øt gi·ªØa c√°c switch, Switch‚ÄìRouter                |

#### 4. VTP

![alt text](./images/image-4.png)

VTP domain (hay c√≤n ƒë∆∞·ª£c g·ªçi l√† VLAN managerment domain) bao g·ªìm 1 SW ho·∫∑c m·ªôt v√†i SW k·∫øt n·ªëi v·ªõi nhau v·ªõi nhi·ªám v·ª• qu·∫£n tr·ªã 1 VTP domain name. 1 SW ch·ªâ c√≥ th·ªÉ n·∫±m trong 1 VTP domain.

X√©t trong h·ªá th·ªëng c√≥ 30 Switch: t·∫•t c·∫£ c√°c Switch ƒë·ªÅu c√≥ VLAN 10, 20, 30, 40, 50 v√† t√™n c·ªßa c√°c VLAN nh∆∞ IT, Sale.... B√¨nh th∆∞·ªùng ta ph·∫£i ƒëi c·∫•u h√¨nh l·∫ßn l∆∞·ª£t 30 Switch nh∆∞ng khi d√πng VTP th√¨ ch·ªâ c·∫ßn c·∫•u h√¨nh c√°c VLAN tr√™n m·ªôt Switch Server sau ƒë√≥ ƒë·ªìng nh·∫•t v·ªõi c√°c Switch c√≤n l·∫°i l√† xong.

VTP l√† VLAN Trunking Protocol. L√† giao th·ª©c ƒë·ªôc quy·ªÅn c·ªßa thi·∫øt b·ªã Cisco. N√≥ cho ph√©p tri·ªÉn khai ƒë·ªìng nh·∫•t nhi·ªÅu VLAN c√πng m·ªôt l√∫c xu·ªëng nhi·ªÅu Switch kh√°c nhau trong h·ªá th·ªëng m·∫°ng l·ªõn.

**C√°c mode ho·∫°t ƒë·ªông**

1. Mode server:

- C√≥ quy·ªÅn t·∫°o VLAN, S·ª≠a VLAN, X√≥a VLAN
- C√≥ quy·ªÅn g·ª≠i th√¥ng tin ƒëi cho c√°c Switch kh√°c
- C√≥ th·ªÉ h·ªçc th√¥ng tin t·ª´ Switch kh√°c sau ƒë√≥ chuy·ªÉn ƒëi cho switch kh√°c h·ªçc
2. Mode Client:

- Kh√¥ng th·ªÉ t·∫°o, s·ª≠a, x√≥a VLAN
- N√≥ c√≥ th·ªÉ g·ª≠i ƒëi th√¥ng tin ƒëi cho SW kh√°c h·ªçc.

3. Mode Transparent:

- C√≥ th·ªÉ t·∫°o, s·ª≠a, x√≥a VLAN nh∆∞ng ch·ªâ trong n·ªô b·ªô c·ªßa Switch ƒë√≥ th√¥i
- Kh√¥ng ƒë·ªìng b·ªô c≈©ng kh√¥ng g·ª≠i th√¥ng tin c·∫•u h√¨nh ƒëi cho ng∆∞·ªùi kh√°c.
- L√†m tr·∫°m trung chuy·ªÉn c√°c th√¥ng tin qu·∫£ng b√° c·ªßa VTP t·ªõi Client

Ch√∫ √Ω: Khi n√†o th√¨ d√πng Transparent: Tr√™n SW Server c√≥ 5 VLAN: 2 t·ªõi 5. Nh∆∞ng VLAN 2 l√† ph√≤ng Sale c√≥ nhi·ªÅu nh√¢n vi√™n n√™n c·∫ßn c√≥ SW m·ªü r·ªông nhi·ªÅu c·ªïng. L√∫c n√†y tr√™n SW transparent ch·ªâ c·∫ßn c·∫•u m√¨nh m√¨nh VLAN 2. SW transparent s·∫Ω kh√¥ng c·∫≠p nh·∫≠t th√¥ng tin c·ªßa c√°c VLAN kh√°c.
C√°ch ho·∫°t ƒë·ªông c·ªßa giao th·ª©c VTP

**ƒêi·ªÅu ki·ªán ƒë·ªÉ VTP ho·∫°t ƒë·ªông**

Ta c√≥ t·∫•t c·∫£ c√°c Switch ƒë∆∞·ª£c k·∫øt n·ªëi t·ªõi m·ªôt Switch t·ªïng b·∫±ng ƒë∆∞·ªùng Trunking.

To√†n b·ªô c√°c Switch n√†y ƒë∆∞·ª£c ƒë·∫∑t trong m·ªôt mi·ªÅn l√† Dnu n√≥ s·∫Ω trao ƒë·ªïi th√¥ng tin ƒë∆∞·ª£c v·ªõi nhau.

**C√°c b∆∞·ªõc ho·∫°t ƒë·ªông**

B∆∞·ªõc 1: Khi c√≥ thay ƒë·ªïi th√¥ng tin tr√™n con Switch t·ªïng nh∆∞ s·ª≠a, x√≥a t√™n ho·∫∑c th√¥ng tin VLAN th√¨ ch·ªâ s·ªë VTP Revision s·∫Ω tƒÉng l√™n 1.

=> S·ªë Revision l√† b·ªô ƒë·∫øm khi c√≥ s·ª± thay ƒë·ªïi trong c∆° s·ªü d·ªØ li·ªáu c·ªßa VLAN. M·ªói l·∫ßn s·ª≠a n√≥ s·∫Ω tƒÉng l√™n 1.

B∆∞·ªõc 2: Khi Revision tƒÉng ngay l·∫≠p t·ª©c c√°c g√≥i tin s·∫Ω g·ª≠i t·ªõi c√°c Switch trong mi·ªÅn th√¥ng qua ƒë∆∞·ªùng Trunk. C·ª© 5 ph√∫t n√≥ l·∫°i g·ª≠i m·ªôt l·∫ßn.

B∆∞·ªõc 3: C√°c Switch c√≤n l·∫°i trong mi·ªÅn s·∫Ω so s√°nh ch·ªâ s·ªë Revision. N·∫øu th·∫•y th√¥ng tin ƒë·∫øn c√≥ ch·ªâ s·ªë Revision cao h∆°n n√≥ s·∫Ω c·∫≠p nh·∫≠t d·ªØ li·ªáu.

**X√¢y d·ª±ng Backup cho h·ªá th·ªëng**

ƒê·ªÉ tƒÉng t√≠nh d·ª± ph√≤ng ng∆∞·ªùi ta th∆∞·ªùng d√πng t·ªëi hi·ªÉu 2 Switch ho·∫°t ƒë·ªông ·ªü ch·∫ø ƒë·ªô Server.

=> ƒêi·ªÅu ki·ªán b√¨nh th∆∞·ªùng: khi c√≥ s·ª± thay ƒë·ªïi tr√™n Switch Server 1 th√¨ Switch Server 2 s·∫Ω h·ªçc. N√≥ s·∫Ω ƒë·∫£m b·∫£o duy tr√¨ cho th·ªá th·ªëng.

=> ƒêi·ªÅu ki·ªán thay ƒë·ªïi: khi m·ªôt Switch Server c·∫Øm v√†o h·ªá th·ªëng m·ªõi n·∫øu ch·ªâ s·ªë Revision cao h∆°n Server hi·ªán t·∫°i n√≥ s·∫Ω l√†m sai l·ªách th√¥ng tin VLAN. B·ªüi v·∫≠y tr∆∞·ªõc khi c·∫Øm v√†o ph·∫£i chuy·ªÉn n√≥ sang mode Client ho·∫∑c Transparen r·ªìi m·ªõi chuy·ªÉn l·∫°i mode Server.

**Ch·ªëng t·∫•n c√¥ng DoS d√πng VTP**

ƒê·ªÉ ch·ªëng t·∫•n c√¥ng DoS ta ƒë·∫∑t m·∫≠t kh·∫©u VTP

**VTP Pruning**

Ch·ªëng l√£ng ph√≠ l∆∞u l∆∞·ª£ng ƒë∆∞·ªùng truy·ªÅn (d√†nh cho h·ªá th·ªëng c√≥ VTP Server v√† VTP Transparent)

Khi b·∫≠t t√≠nh nƒÉng n√†y t·ª´ Switch Server c√°c Switch Client s·∫Ω h·ªçc.

Khi Client nh·∫≠n ƒë∆∞·ª£c VTP Pruning n√≥ s·∫Ω th√¥ng b√°o l·∫°i c√≥ nh·ªØng VLAN n√†o tr√™n n√≥. Khi m·ªôt g√≥i tin t·ª´ m·ªôt VLAN g·ª≠i ƒëi Switch Server s·∫Ω bi·∫øt v√† kh√¥ng g·ª≠i v√†o nh·ªØng Switch kh√¥ng c√≥ VLAN ƒë√≥.

**C·∫•u h√¨nh VTP domain**

a. C√¢u l·ªánh c·∫•u h√¨nh t·ªïng quan:
```plaintext
SW(config)#vtp  mode [Server | Client | Transparent ]

SW(config)#vtp  domain  domain-name

SW(config)#vtp pasword  abc

SW(config)#vtp version number

SW(config)#vtp pruning

SW(config)#end
```

b. C√¢u l·ªánh chi ti·∫øt:

Tr√™n Switch Server:

Kh·ªüi t·∫°o VTP Server:
     
   
         SW(config)#vtp  mode Server

          SW(config)#vtp  domain  dnu

          SW(config)#vtp pasword  abc

          SW(config)#vtp version 2

          SW(config)#vtp pruning (Packet tracer kh√¥ng h·ªó tr·ª£).

          SW(config)#end
          

B·∫≠t ƒë∆∞·ªùng Trunking c·ªßa c·ªïng k·∫øt n·ªëi t·ªõi c√°c SW Client:

          SW(config)#interface f0/24

          SW(config-if)#switchport mode trunk

Kh·ªüi t·∫°o t√™n VLAN:

          SW(config)#vlan 2

          SW(config)#name IT

          SW(config)#exit

          SW(config)#vlan 3

          SW(config)#name Sale

          SW(config)#exit

Tr√™n Switch Transparent:

     SW(config)#vtp  mode transparent

     SW(config)#vtp  domain  dnu

     SW(config)#vtp pasword  abc

     SW(config)#vtp pruning  (Packet tracer kh√¥ng h·ªó tr·ª£).

     SW(config)#end

Tr√™n Switch VTP Client:

Kh·ªüi t·∫°o VTP Client:

          SW(config)#vtp  mode client

          SW(config)#vtp  domain  dnu

          SW(config)#vtp pasword  abc

          SW(config)#vtp pruning  (Packet tracer kh√¥ng h·ªó tr·ª£).

          SW(config)#end

G√°n c·ªïng cho SW: Ph·∫£i g√°n c·ªïng cho SW v√¨ VTP Server kh√¥ng g·ª≠i th√¥ng tin g√°n c·ªïng cho Client.

          SW(config)#interface range f0/1-10

          SW(config-if-range)#switchport access vlan 2

          SW(config-if-range)#exit

          SW(config)#interface range f0/11-20

          SW(config-if-range)#switchport access vlan 3

          SW(config-if-range)#exit

c. C√°c l·ªánh ki·ªÉm tra sau khi c·∫•u h√¨nh:
```plaintext
SW(config)# show vtp status

SW(config)# show vtp pasword

SW(config)# show vlan

SW(config)# Show interfaces trunk
```

##### 5. STP (Spanning Tree Protocol) 
STP (Spanning Tree Protocol) l√† m·ªôt giao th·ª©c m·∫°ng Layer 2 (Datalink Layer) gi√∫p ngƒÉn ch·∫∑n c√°c v√≤ng l·∫∑p (loops) trong m·∫°ng Ethernet b·∫±ng c√°ch t·∫°o ra m·ªôt c√¢y bao tr√πm (spanning tree) ƒë·ªÉ ƒë·∫£m b·∫£o ch·ªâ c√≥ m·ªôt ƒë∆∞·ªùng d·∫´n ho·∫°t ƒë·ªông gi·ªØa c√°c switch.


1. T·∫°i sao c·∫ßn Spanning Tree Protocol (STP)

Trong m·∫°ng LAN nhi·ªÅu switch, n·∫øu c√≥ ƒë∆∞·ªùng k·∫øt n·ªëi d·ª± ph√≤ng ƒë·ªÉ tƒÉng ƒë·ªô tin c·∫≠y, s·∫Ω d·ªÖ t·∫°o ra v√≤ng l·∫∑p (loop).
V√≤ng l·∫∑p ·ªü t·∫ßng 2 (Layer 2) r·∫•t nguy hi·ªÉm v√¨:

- Broadcast Storm: g√≥i tin qu·∫£ng b√° (broadcast) nh√¢n b·∫£n v√¥ h·∫°n ‚Üí t·∫Øc ngh·∫Ωn m·∫°ng.
- B·∫£ng MAC b·ªã lo·∫°n: switch h·ªçc sai ƒë·ªãa ch·ªâ MAC do g√≥i tin ƒëi v√≤ng.
- T·ªën bƒÉng th√¥ng & CPU.

Gi·∫£i ph√°p: STP s·∫Ω t·ª± ƒë·ªông t·∫Øt (block) m·ªôt s·ªë c·ªïng ƒë·ªÉ lo·∫°i b·ªè v√≤ng l·∫∑p, nh∆∞ng v·∫´n gi·ªØ ƒë∆∞·ªùng d·ª± ph√≤ng ƒë·ªÉ d√πng khi c·∫ßn.

2. **Nguy√™n t·∫Øc ho·∫°t ƒë·ªông c·ªßa STP**

- STP coi m·∫°ng LAN l√† m·ªôt c√¢y logic kh√¥ng v√≤ng (spanning tree).

C√°c b∆∞·ªõc ch√≠nh:

- Ch·ªçn Root Switch (switch ‚Äúg·ªëc‚Äù c·ªßa m·∫°ng).

- Ch·ªçn Root Port tr√™n m·ªói switch (c·ªïng g·∫ßn root nh·∫•t).

- Ch·ªçn Designated Port tr√™n m·ªói ƒëo·∫°n m·∫°ng (c·ªïng ƒë∆∞·ª£c ph√©p forward).

- C√°c c·ªïng c√≤n l·∫°i ‚Üí Blocking (kh√¥ng chuy·ªÉn d·ªØ li·ªáu).

3. C√°ch ch·ªçn Root Switch
- M·ªói switch c√≥ Bridge ID (BID) = Priority (32768 m·∫∑c ƒë·ªãnh) + MAC Address.
- Switch c√≥ BID th·∫•p nh·∫•t ‚Üí tr·ªü th√†nh Root Switch.
- C√≥ th·ªÉ thay ƒë·ªïi Priority ƒë·ªÉ ƒëi·ªÅu khi·ªÉn switch n√†o l√†m Root.
4. C√°ch ch·ªçn Root Port
- Root Port l√† c·ªïng tr√™n switch kh√¥ng ph·∫£i root nh∆∞ng c√≥ ƒë∆∞·ªùng ng·∫Øn nh·∫•t ƒë·∫øn Root Switch.
- ƒê·ªô d√†i ƒë∆∞·ªùng ‚Üí Cost (t√≠nh d·ª±a tr√™n t·ªëc ƒë·ªô link: 100 Mbps = cost 19, 1 Gbps = cost 4...).
5. C√°ch ch·ªçn Designated Port
- Tr√™n m·ªói segment (ƒëo·∫°n m·∫°ng), ch·ªçn 1 c·ªïng ƒë·ªÉ forward traffic ‚Üí Designated Port.
- Switch c√≥ ƒë∆∞·ªùng ng·∫Øn nh·∫•t ƒë·∫øn root s·∫Ω gi·ªØ Designated Port cho segment ƒë√≥.
6. Tr·∫°ng th√°i c·ªïng trong STP
- STP truy·ªÅn th·ªëng (IEEE 802.1D) c√≥ 5 tr·∫°ng th√°i:
- Blocking ‚Äì Kh√¥ng chuy·ªÉn d·ªØ li·ªáu, ch·ªâ nghe BPDU.
- Listening ‚Äì Chu·∫©n b·ªã g·ª≠i/nh·∫≠n th√¥ng tin c·∫•u tr√∫c m·∫°ng.
- Learning ‚Äì H·ªçc ƒë·ªãa ch·ªâ MAC nh∆∞ng ch∆∞a forward d·ªØ li·ªáu.
- Forwarding ‚Äì Chuy·ªÉn d·ªØ li·ªáu.
- Disabled ‚Äì C·ªïng b·ªã t·∫Øt th·ªß c√¥ng.
7. BPDU (Bridge Protocol Data Unit)
- G√≥i tin ƒëi·ªÅu khi·ªÉn m√† switch g·ª≠i ƒë·ªÉ trao ƒë·ªïi th√¥ng tin STP.
- D√πng ƒë·ªÉ b·∫ßu ch·ªçn Root v√† c·∫≠p nh·∫≠t topology.
8. Rapid STP (RSTP - IEEE 802.1w)
- N√¢ng c·∫•p t·ª´ STP truy·ªÅn th·ªëng ‚Üí h·ªôi t·ª• nhanh h∆°n (g·∫ßn nh∆∞ t·ª©c th√¨).
- G·ªôp tr·∫°ng th√°i th√†nh:
- Discarding (k·∫øt h·ª£p Blocking + Listening).
- Learning.
- Forwarding.

C√≥ th√™m vai tr√≤ c·ªïng:

- Alternate Port: d·ª± ph√≤ng cho Root Port.
- Backup Port: d·ª± ph√≤ng cho Designated Port.
9. C√°c t√≠nh nƒÉng STP t√πy ch·ªçn
PortFast: C·ªïng n·ªëi tr·ª±c ti·∫øp v·ªõi PC b·ªè qua giai ƒëo·∫°n STP ‚Üí v√†o Forwarding ngay.
- BPDU Guard: N·∫øu nh·∫≠n BPDU ·ªü c·ªïng PortFast ‚Üí t·∫Øt c·ªïng (ngƒÉn switch l·∫°).
- EtherChannel: G·ªôp nhi·ªÅu ƒë∆∞·ªùng v·∫≠t l√Ω th√†nh 1 link logic, tr√°nh STP block b·ªõt link.

**V√≠ d·ª• minh h·ªça d·ªÖ hi·ªÉu**

- H√£y t∆∞·ªüng t∆∞·ª£ng c√°c switch nh∆∞ giao l·ªô v√† c√°c c·ªïng nh∆∞ ƒë√®n giao th√¥ng:
- STP l√† c·∫£nh s√°t giao th√¥ng quy·∫øt ƒë·ªãnh ch·ªó n√†o b·∫≠t ƒë√®n xanh (forward), ch·ªó n√†o ƒë√®n ƒë·ªè (block) ƒë·ªÉ kh√¥ng b·ªã ƒëi v√≤ng ho√†i.
- N·∫øu m·ªôt giao l·ªô ch√≠nh b·ªã ch·∫∑n (Root Port h·ªèng) ‚Üí c·∫£nh s√°t ƒë·ªïi ƒë√®n ƒë·ªè th√†nh xanh ·ªü ƒë∆∞·ªùng d·ª± ph√≤ng.
